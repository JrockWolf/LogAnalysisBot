<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Log Analysis Helper</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h1>Log Analysis Helper</h1>
    <p class="subtitle">
      Upload a log file or paste log lines. We auto-detect gzip/zip and common encodings.
    </p>
    
    {% if error %}
    <div class="error-message" style="background-color: #fee; border: 1px solid #c33; color: #c33; padding: 12px; border-radius: 4px; margin-bottom: 20px;">
      <strong>Error:</strong> {{ error }}
    </div>
    {% endif %}

    <!-- Two-column grid -->
    <div class="grid-results">
      <!-- LEFT COLUMN: Upload -->
      <div>
        <h2>Upload Log File</h2>
        <form id="uploadForm" action="/analyze" method="post" enctype="multipart/form-data" style="margin-bottom:12px">
          <label class="meta" for="upload">Select a file:</label><br/>
          <input type="file" name="upload" id="upload" accept=".log,.txt,.json,.csv,.gz,.zip" class="file-input" />
          <div class="actions" style="margin-top:10px;">
            <button type="submit">Analyze</button>
            <button type="button" class="secondary" onclick="document.getElementById('upload').value=''">Clear</button>
          </div>
        </form>
        <p class="meta">Tip: You can also drag and drop a file anywhere on the page to analyze it automatically.</p>
      </div>

      <!-- RIGHT COLUMN: Paste -->
      <div>
        <h2>Paste Log Text</h2>
        <form id="pasteForm" action="/analyze" method="post">
          <textarea name="pasted" rows="12" placeholder="Paste logs here..."></textarea>
          <div class="actions">
            <button type="submit">Analyze</button>
            <button type="button" class="secondary" onclick="document.querySelector('[name=pasted]').value=''">Clear</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Drag & drop anywhere â†’ feeds file input and submits upload form
    const uploadForm = document.getElementById('uploadForm');
    window.addEventListener('dragover', e => { e.preventDefault(); document.body.classList.add('dragging'); });
    window.addEventListener('dragleave', e => { document.body.classList.remove('dragging'); });
    window.addEventListener('drop', e => {
      e.preventDefault(); document.body.classList.remove('dragging');
      if (!e.dataTransfer.files?.length) return;
      const input = uploadForm.querySelector('input[type=file]');
      input.files = e.dataTransfer.files;
      uploadForm.submit();
    });
  </script>
</body>
</html>
